<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Crosshair</title>
    <meta name="description" content="A collection of components that make it easy to build interactive charts with D3.">

    <script src="https://d3fc.io/scripts.js"></script>

    <link rel="icon" type="image/png" href="https://d3fc.io/images/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="https://d3fc.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://d3fc.io/images/favicon-96x96.png" sizes="96x96">
    <link rel="stylesheet" href="https://d3fc.io/styles.css" />
    <link rel="canonical" href="https://d3fc.io/components/tool/crosshair.html" />
  </head>
  <body>
    <div class="content">

      <nav class="navbar navbar-inverse">
        <div class="container">
            <div class="navbar-header">
              <a href="https://d3fc.io/"><img class="navbar-logo" alt="d3fc" src="https://d3fc.io/images/logo.svg" /></a>
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              </div>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav navbar-right">
                <li class=""><a href="https://d3fc.io/components/introduction/getting-started.html">Documentation</a></li>
                <li class="active"><a href="https://d3fc.io/components/chart/cartesian.html">Components</a></li>
                <li class=""><a href="https://d3fc.io/components/series/candlestick.html">Financial</a></li>
                <li class=""><a href="https://d3fc.io/examples">Examples</a></li>
                <li><a href="https://github.com/ScottLogic/d3fc">GitHub</a></li>
              </ul>
            </div>
        </div>
      </nav>

      <div class="container component">
  <div class="row">

    <div class="col-sm-9 col-xs-12">
      <h1>
        Crosshair
        <a class="btn btn-default" href="https://github.com/ScottLogic/d3fc/blob/master/src/tool/crosshair.js">View source</a>
      </h1>
      <p>The crosshair component renders an interactive crosshair. The component should be data-joined to an empty array which it will populate with an object that indicates the current crosshair location.</p>
<p>The crosshair is typically rendered alongside other series. The following example uses a multi-series component to render a crosshair and a line series:</p>
<pre><code class="lang-js"><span class="hljs-comment">// create a line series and a crosshair</span>
<span class="hljs-built_in">var</span> line = fc.series.line()
    .xValue(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.date; })
    .yValue(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.close; });
<span class="hljs-built_in">var</span> crosshair = fc.tool.crosshair();

<span class="hljs-comment">// create an array which will hold the crosshair datapoint</span>
<span class="hljs-built_in">var</span> crosshairData = [];

<span class="hljs-comment">// use a multi-series to render both the line and crosshair</span>
<span class="hljs-built_in">var</span> multi = fc.series.multi()
  .series([line, crosshair])
  .xScale(xScale)
  .yScale(yScale)
  .mapping(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">series</span>) </span>{
      <span class="hljs-keyword">switch</span> (series) {
      <span class="hljs-keyword">case</span> <span class="hljs-attribute">line</span>:
          <span class="hljs-keyword">return</span> data;
      <span class="hljs-keyword">case</span> <span class="hljs-attribute">crosshair</span>:
          <span class="hljs-keyword">return</span> crosshairData;
      }
  });

container.datum(data)
    .call(multi);
</code></pre>
<p>Which gives the following:</p>
<div class="codepen-link">
  <form action="https://codepen.io/pen/define" method="POST" target="_blank">
    <input type="text" name="data" hidden="true"
      value='{
        "html":"&lt;div id&#x3D;\&quot;crosshair\&quot; class&#x3D;\&quot;chart\&quot;&gt;&lt;/div&gt;\n",
        "js": "var width = 500, height = 250;\nvar container = d3.select(\"#crosshair\")\n    .append(\"svg\")\n    .attr({\"width\": width, \"height\": height});\n\nvar dataGenerator = fc.data.random.financial()\n    .startDate(new Date(2014, 1, 1));\nvar data = dataGenerator(50);\n\nvar xScale = fc.scale.dateTime()\n    .domain(fc.util.extent().fields(\"date\")(data))\n    .range([0, width]);\n\nvar yScale = d3.scale.linear()\n    .domain(fc.util.extent().fields([\"high\", \"low\"])(data))\n    .range([height, 0]);\n\n//START\n// create a line series and a crosshair\nvar line = fc.series.line()\n    .xValue(function(d) { return d.date; })\n    .yValue(function(d) { return d.close; });\nvar crosshair = fc.tool.crosshair();\n\n// create an array which will hold the crosshair datapoint\nvar crosshairData = [];\n\n// use a multi-series to render both the line and crosshair\nvar multi = fc.series.multi()\n  .series([line, crosshair])\n  .xScale(xScale)\n  .yScale(yScale)\n  .mapping(function(series) {\n      switch (series) {\n      case line:\n          return data;\n      case crosshair:\n          return crosshairData;\n      }\n  });\n\ncontainer.datum(data)\n    .call(multi);\n//END\n",
        "css": ".chart {\n    margin: 10px 0;\n    width: 100%;\n    height: 250px;\n}\n\n.chart&gt;svg {\n    margin-left: auto;\n    margin-right: auto;\n}\n\n.chart.large {\n    height: 400px;\n}\n",
        "js_external": "https://d3fc.io/d3fc.bundle.js",
        "css_external": "https://d3fc.io/d3fc.css"}
      '/>
    <input type="submit" class="btn btn-default" value="Codepen"/>
  </form>
</div>


<div id='crosshair' class='chart'></div>

<script type="text/javascript">
var width = 500, height = 250;
var container = d3.select('#crosshair')
    .append('svg')
    .attr({'width': width, 'height': height});

var dataGenerator = fc.data.random.financial()
    .startDate(new Date(2014, 1, 1));
var data = dataGenerator(50);

var xScale = fc.scale.dateTime()
    .domain(fc.util.extent().fields('date')(data))
    .range([0, width]);

var yScale = d3.scale.linear()
    .domain(fc.util.extent().fields(['high', 'low'])(data))
    .range([height, 0]);

//START
// create a line series and a crosshair
var line = fc.series.line()
    .xValue(function(d) { return d.date; })
    .yValue(function(d) { return d.close; });
var crosshair = fc.tool.crosshair();

// create an array which will hold the crosshair datapoint
var crosshairData = [];

// use a multi-series to render both the line and crosshair
var multi = fc.series.multi()
  .series([line, crosshair])
  .xScale(xScale)
  .yScale(yScale)
  .mapping(function(series) {
      switch (series) {
      case line:
          return data;
      case crosshair:
          return crosshairData;
      }
  });

container.datum(data)
    .call(multi);
//END

</script>

<p>You can control the snapping behaviour of the crosshair by supplying a snapping function to the <code>snap</code> property. A number of snap functions are <a href="https://github.com/ScottLogic/d3fc/blob/master/src/util/snap.js">supplied as part of the library</a>.</p>
<p>You can configure X and Y labels via the <code>xLabel</code> and <code>yLabel</code> properties. The crosshair emits <code>trackingstart</code>, <code>trackingmove</code> and <code>trackingend</code> events which can be used to add further interactively.</p>
<p>The crosshair is often used in conjunction with the <a href="/components/chart/tooltip.html">tooltip component</a>, which renders the data that the crosshair generates (and pushes into the data-joined array). In order to update the tooltip component, the entire chart should be re-rendered by handling the crosshair tracking events.</p>
<p>While the tooltip can be rendered into any suitable container, it often makes sense to render it within the same region as the series. In order to achieve this, the tooltip can be positioned by the <a href="/components/layout/rectangles.html">rectangles layout component</a>.</p>
<p>The following shows how these various components can be integrated together:</p>
<pre><code class="lang-js"><span class="hljs-built_in">var</span> numberFormat = d3.format(<span class="hljs-string">'.2f'</span>);

<span class="hljs-built_in">var</span> line = fc.series.line()
    .xValue(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.date; })
    .yValue(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.close; });

<span class="hljs-built_in">var</span> crosshair = fc.tool.crosshair()
  .xLabel(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> numberFormat(d.x); })
  .yLabel(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> numberFormat(d.y); })
  .on(<span class="hljs-string">'trackingstart'</span>, render)
  .on(<span class="hljs-string">'trackingmove'</span>, render)
  .on(<span class="hljs-string">'trackingend'</span>, render);

<span class="hljs-built_in">var</span> tooltip = fc.chart.tooltip()
    .items([
        [<span class="hljs-string">'X:'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> numberFormat(d.x); }],
        [<span class="hljs-string">'Y:'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> numberFormat(d.y); }]
    ]);

<span class="hljs-built_in">var</span> tooltipLayout = fc.layout.rectangles()
    .position([<span class="hljs-number">10</span>, <span class="hljs-number">10</span>])
    .size([<span class="hljs-number">50</span>, <span class="hljs-number">30</span>])
    .component(tooltip);

<span class="hljs-comment">// create an array which will hold the crosshair datapoint</span>
<span class="hljs-built_in">var</span> crosshairData = [];

<span class="hljs-comment">// use a multi-series to render both the line, crosshair and tooltip</span>
<span class="hljs-built_in">var</span> multi = fc.series.multi()
  .series([line, crosshair, tooltipLayout])
  .xScale(xScale)
  .yScale(yScale)
  .mapping(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">series</span>) </span>{
      <span class="hljs-keyword">switch</span> (series) {
      <span class="hljs-keyword">case</span> <span class="hljs-attribute">line</span>:
          <span class="hljs-keyword">return</span> data;
      <span class="hljs-keyword">case</span> <span class="hljs-attribute">crosshair</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-attribute">tooltipLayout</span>:
          <span class="hljs-keyword">return</span> crosshairData;
      }
  });

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params"></span>) </span>{
    container
      .datum(data)
      .call(multi);
}
render();
</code></pre>
<p>This renders a tooltip in the top-left corner:</p>
<div class="codepen-link">
  <form action="https://codepen.io/pen/define" method="POST" target="_blank">
    <input type="text" name="data" hidden="true"
      value='{
        "html":"&lt;div id&#x3D;\&quot;crosshair-2\&quot; class&#x3D;\&quot;chart\&quot;&gt;&lt;/div&gt;\n",
        "js": "var width = 500, height = 250;\nvar container = d3.select(\"#crosshair-2\")\n    .append(\"svg\")\n    .attr({\"width\": width, \"height\": height});\n\nvar dataGenerator = fc.data.random.financial()\n    .startDate(new Date(2014, 1, 1));\nvar data = dataGenerator(50);\n\nvar xScale = fc.scale.dateTime()\n    .domain(fc.util.extent().fields(\"date\")(data))\n    .range([0, width]);\n\nvar yScale = d3.scale.linear()\n    .domain(fc.util.extent().fields([\"high\", \"low\"])(data))\n    .range([height, 0]);\n\n//START\nvar numberFormat = d3.format(\".2f\");\n\nvar line = fc.series.line()\n    .xValue(function(d) { return d.date; })\n    .yValue(function(d) { return d.close; });\n\nvar crosshair = fc.tool.crosshair()\n  .xLabel(function(d) { return numberFormat(d.x); })\n  .yLabel(function(d) { return numberFormat(d.y); })\n  .on(\"trackingstart\", render)\n  .on(\"trackingmove\", render)\n  .on(\"trackingend\", render);\n\nvar tooltip = fc.chart.tooltip()\n    .items([\n        [\"X:\", function(d) { return numberFormat(d.x); }],\n        [\"Y:\", function(d) { return numberFormat(d.y); }]\n    ]);\n\nvar tooltipLayout = fc.layout.rectangles()\n    .position([10, 10])\n    .size([50, 30])\n    .component(tooltip);\n\n// create an array which will hold the crosshair datapoint\nvar crosshairData = [];\n\n// use a multi-series to render both the line, crosshair and tooltip\nvar multi = fc.series.multi()\n  .series([line, crosshair, tooltipLayout])\n  .xScale(xScale)\n  .yScale(yScale)\n  .mapping(function(series) {\n      switch (series) {\n      case line:\n          return data;\n      case crosshair:\n      case tooltipLayout:\n          return crosshairData;\n      }\n  });\n\nfunction render() {\n    container\n      .datum(data)\n      .call(multi);\n}\nrender();\n//END\n",
        "css": ".chart {\n    margin: 10px 0;\n    width: 100%;\n    height: 250px;\n}\n\n.chart&gt;svg {\n    margin-left: auto;\n    margin-right: auto;\n}\n\n.chart.large {\n    height: 400px;\n}\n",
        "js_external": "https://d3fc.io/d3fc.bundle.js",
        "css_external": "https://d3fc.io/d3fc.css"}
      '/>
    <input type="submit" class="btn btn-default" value="Codepen"/>
  </form>
</div>


<div id='crosshair-2' class='chart'></div>

<script type="text/javascript">
var width = 500, height = 250;
var container = d3.select('#crosshair-2')
    .append('svg')
    .attr({'width': width, 'height': height});

var dataGenerator = fc.data.random.financial()
    .startDate(new Date(2014, 1, 1));
var data = dataGenerator(50);

var xScale = fc.scale.dateTime()
    .domain(fc.util.extent().fields('date')(data))
    .range([0, width]);

var yScale = d3.scale.linear()
    .domain(fc.util.extent().fields(['high', 'low'])(data))
    .range([height, 0]);

//START
var numberFormat = d3.format('.2f');

var line = fc.series.line()
    .xValue(function(d) { return d.date; })
    .yValue(function(d) { return d.close; });

var crosshair = fc.tool.crosshair()
  .xLabel(function(d) { return numberFormat(d.x); })
  .yLabel(function(d) { return numberFormat(d.y); })
  .on('trackingstart', render)
  .on('trackingmove', render)
  .on('trackingend', render);

var tooltip = fc.chart.tooltip()
    .items([
        ['X:', function(d) { return numberFormat(d.x); }],
        ['Y:', function(d) { return numberFormat(d.y); }]
    ]);

var tooltipLayout = fc.layout.rectangles()
    .position([10, 10])
    .size([50, 30])
    .component(tooltip);

// create an array which will hold the crosshair datapoint
var crosshairData = [];

// use a multi-series to render both the line, crosshair and tooltip
var multi = fc.series.multi()
  .series([line, crosshair, tooltipLayout])
  .xScale(xScale)
  .yScale(yScale)
  .mapping(function(series) {
      switch (series) {
      case line:
          return data;
      case crosshair:
      case tooltipLayout:
          return crosshairData;
      }
  });

function render() {
    container
      .datum(data)
      .call(multi);
}
render();
//END

</script>


      <nav class="visible-xs-block">
        <ul class="pager">
            <li class="previous"><a href="/components/tool/container.html"><span aria-hidden="true">&larr;</span> Container</a></li>
            <li class="next"><a href="/components/util/extent.html">Extent <span aria-hidden="true">&rarr;</span></a></li>
        </ul>
      </nav>
    </div>

    <nav class="col-sm-3 hidden-xs">
      <ul class="nav nav-stacked fixed nav-sidebar">
          <li>
            <h4>Chart</h4>
            <ul class="nav nav-stacked">
                <li class="">
                  <a href="/components/chart/cartesian.html">
                    Cartesian
                  </a>
                </li>
                <li class="">
                  <a href="/components/chart/legend.html">
                    Legend
                  </a>
                </li>
                <li class="">
                  <a href="/components/chart/small-multiples.html">
                    Small Multiples
                  </a>
                </li>
                <li class="">
                  <a href="/components/chart/sparkline.html">
                    Sparkline
                  </a>
                </li>
                <li class="">
                  <a href="/components/chart/tooltip.html">
                    Tooltip
                  </a>
                </li>
            </ul>
          </li>
          <li>
            <h4>Series</h4>
            <ul class="nav nav-stacked">
                <li class="">
                  <a href="/components/series/area.html">
                    Area Series
                  </a>
                </li>
                <li class="">
                  <a href="/components/series/bar.html">
                    Bar Series
                  </a>
                </li>
                <li class="">
                  <a href="/components/series/boxPlot.html">
                    Box Plot Series
                  </a>
                </li>
                <li class="">
                  <a href="/components/series/cycle.html">
                    Cycle Series
                  </a>
                </li>
                <li class="">
                  <a href="/components/series/errorBar.html">
                    Error Bar Series
                  </a>
                </li>
                <li class="">
                  <a href="/components/series/grouped-bar.html">
                    Grouped Bar Series
                  </a>
                </li>
                <li class="">
                  <a href="/components/series/line.html">
                    Line Series
                  </a>
                </li>
                <li class="">
                  <a href="/components/series/multi.html">
                    Multi Series
                  </a>
                </li>
                <li class="">
                  <a href="/components/series/point.html">
                    Point Series
                  </a>
                </li>
                <li class="">
                  <a href="/components/series/stacked.html">
                    Stacked Series
                  </a>
                </li>
                <li class="">
                  <a href="/components/series/waterfall.html">
                    Waterfall Series
                  </a>
                </li>
            </ul>
          </li>
          <li>
            <h4>Annotation</h4>
            <ul class="nav nav-stacked">
                <li class="">
                  <a href="/components/annotation/band.html">
                    Band
                  </a>
                </li>
                <li class="">
                  <a href="/components/annotation/gridlines.html">
                    Gridlines
                  </a>
                </li>
                <li class="">
                  <a href="/components/annotation/line.html">
                    Line
                  </a>
                </li>
            </ul>
          </li>
          <li>
            <h4>Data</h4>
            <ul class="nav nav-stacked">
                <li class="">
                  <a href="/components/data/spread.html">
                    Spread
                  </a>
                </li>
                <li class="">
                  <a href="/components/data/walk.html">
                    Random Walk
                  </a>
                </li>
            </ul>
          </li>
          <li>
            <h4>Layout</h4>
            <ul class="nav nav-stacked">
                <li class="">
                  <a href="/components/layout/flexbox.html">
                    Flexbox
                  </a>
                </li>
                <li class="">
                  <a href="/components/layout/rectangles.html">
                    Rectangles
                  </a>
                </li>
            </ul>
          </li>
          <li>
            <h4>Samplers</h4>
            <ul class="nav nav-stacked">
                <li class="">
                  <a href="/components/sampler/largestTriangleOne.html">
                    Largest Triangle 1 Bucket
                  </a>
                </li>
                <li class="">
                  <a href="/components/sampler/largestTriangleThreeBucket.html">
                    Largest Triangle 3 Buckets
                  </a>
                </li>
                <li class="">
                  <a href="/components/sampler/modeMedian.html">
                    Mode Median
                  </a>
                </li>
            </ul>
          </li>
          <li>
            <h4>Scale</h4>
            <ul class="nav nav-stacked">
                <li class="">
                  <a href="/components/scale/dateTime.html">
                    Date Time Scale
                  </a>
                </li>
            </ul>
          </li>
          <li>
            <h4>SVG</h4>
            <ul class="nav nav-stacked">
                <li class="">
                  <a href="/components/svg/axis.html">
                    Axis
                  </a>
                </li>
            </ul>
          </li>
          <li>
            <h4>Tool</h4>
            <ul class="nav nav-stacked">
                <li class="">
                  <a href="/components/tool/container.html">
                    Container
                  </a>
                </li>
                <li class="active">
                  <a href="/components/tool/crosshair.html">
                    Crosshair
                  </a>
                </li>
            </ul>
          </li>
          <li>
            <h4>Util</h4>
            <ul class="nav nav-stacked">
                <li class="">
                  <a href="/components/util/extent.html">
                    Extent
                  </a>
                </li>
            </ul>
          </li>
      </ul>
    </nav>

  </div>
</div>


    </div>
    <footer>
      <div class="container">
        <p class="muted credit text-center">Project supported by <a href="http://www.scottlogic.com">Scott Logic</a>.</p>
        <p class="muted credit text-center">Browser testing provided by <a class="browserstack" href="https://browserstack.com">BrowserStack</a>.</p>
      </div>
    </footer>

  </body>
</html>
