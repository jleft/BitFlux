<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Bubble Chart</title>
    <meta name="description" content="A collection of components that make it easy to build interactive charts with D3.">

    <script src="https://d3fc.io/scripts.js"></script>

    <link rel="icon" type="image/png" href="https://d3fc.io/images/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="https://d3fc.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://d3fc.io/images/favicon-96x96.png" sizes="96x96">
    <link rel="stylesheet" href="https://d3fc.io/styles.css" />
    <link rel="canonical" href="https://d3fc.io/examples/bubble/index.html" />
  </head>
  <body>
    <div class="content">

      <nav class="navbar navbar-inverse">
        <div class="container">
            <div class="navbar-header">
              <a href="https://d3fc.io/"><img class="navbar-logo" alt="d3fc" src="https://d3fc.io/images/logo.svg" /></a>
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              </div>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav navbar-right">
                <li class=""><a href="https://d3fc.io/components/introduction/getting-started.html">Documentation</a></li>
                <li class=""><a href="https://d3fc.io/components/chart/cartesian.html">Components</a></li>
                <li class=""><a href="https://d3fc.io/components/series/candlestick.html">Financial</a></li>
                <li class="active"><a href="https://d3fc.io/examples">Examples</a></li>
                <li><a href="https://github.com/ScottLogic/d3fc">GitHub</a></li>
              </ul>
            </div>
        </div>
      </nav>

      <div class="container example">
  <div class="row">
    <div class="col-sm-9 col-xs-12">
      <h1>
        Bubble Chart
      </h1>
      <div class="codepen-link">
  <form action="https://codepen.io/pen/define" method="POST" target="_blank">
    <input type="text" name="data" hidden="true"
      value='{
        "html":"&lt;div id&#x3D;\&quot;bubble-chart\&quot; class&#x3D;\&quot;chart large\&quot;&gt;&lt;/div&gt;\n",
        "js": "d3.json(\"https://d3fc.io/examples/bubble/data.json\", function(error, data) {\n    // convert string properties to numbers\n    data.forEach(function(d) {\n        d.income = Number(d.income);\n        d.population = Number(d.population);\n        d.lifeExpectancy = Number(d.lifeExpectancy);\n    });\n\n    var regions = d3.set(data.map(function(d) { return d.region; }));\n    var color = d3.scale.category10()\n        .domain(regions.values());\n\n    var legend = d3.legend.color()\n        .scale(color);\n\n    var size = d3.scale.linear()\n        .range([20, 800])\n        .domain(fc.util.extent().fields(\"population\")(data));\n\n    var pointSeries = fc.series.point()\n        .xValue(function(d) { return d.income; })\n        .yValue(function(d) { return d.lifeExpectancy; })\n        .size(function(d) { return size(d.population); })\n        .decorate(function(sel) {\n            sel.enter()\n                .attr(\"fill\", function(d) { return color(d.region); });\n        });\n\n    var chart = fc.chart.cartesian(\n                  d3.scale.log(),\n                  d3.scale.linear())\n        .xDomain(fc.util.extent().fields(\"income\")(data))\n        .yDomain(fc.util.extent().pad(0.2).fields(\"lifeExpectancy\")(data))\n        .xLabel(\"Income (dollars)\")\n        .yLabel(\"Life expectancy (years)\")\n        .xTicks(2, d3.format(\",d\"))\n        .chartLabel(\"The Wealth & Health of Nations\")\n        .yOrient(\"left\")\n        .margin({left: 40, bottom: 40, top: 30})\n        .plotArea(pointSeries)\n        .decorate(function(selection) {\n            selection.enter()\n                .append(\"g\")\n                .classed(\"legend-container\", true)\n                .layout({\n                    position: \"absolute\",\n                    right: 10,\n                    bottom: 50,\n                    width: 165,\n                    height: 100\n                });\n\n            // compute layout from the parent SVG\n            selection.enter().layout();\n\n            // render the legend\n            selection.select(\"g.legend-container\").call(legend);\n        });\n\n    d3.select(\"#bubble-chart\")\n        .datum(data)\n        .call(chart);\n});\n",
        "css": ".chart {\n    margin: 10px 0;\n    width: 100%;\n    height: 250px;\n}\n\n.chart&gt;svg {\n    margin-left: auto;\n    margin-right: auto;\n}\n\n.chart.large {\n    height: 400px;\n}\n.point path {\n    stroke-width: 0;\n}\n.title text {\n    font-size: 15pt;\n}\n",
        "js_external": "https://d3fc.io/d3fc.bundle.js",
        "css_external": "https://d3fc.io/d3fc.css"}
      '/>
    <input type="submit" class="btn btn-default" value="Codepen"/>
  </form>
</div>


<style>
.point path {
    stroke-width: 0;
}
.title text {
    font-size: 15pt;
}

</style>

<div id='bubble-chart' class='chart large'></div>


<script>
d3.json('https://d3fc.io/examples/bubble/data.json', function(error, data) {
    // convert string properties to numbers
    data.forEach(function(d) {
        d.income = Number(d.income);
        d.population = Number(d.population);
        d.lifeExpectancy = Number(d.lifeExpectancy);
    });

    var regions = d3.set(data.map(function(d) { return d.region; }));
    var color = d3.scale.category10()
        .domain(regions.values());

    var legend = d3.legend.color()
        .scale(color);

    var size = d3.scale.linear()
        .range([20, 800])
        .domain(fc.util.extent().fields('population')(data));

    var pointSeries = fc.series.point()
        .xValue(function(d) { return d.income; })
        .yValue(function(d) { return d.lifeExpectancy; })
        .size(function(d) { return size(d.population); })
        .decorate(function(sel) {
            sel.enter()
                .attr('fill', function(d) { return color(d.region); });
        });

    var chart = fc.chart.cartesian(
                  d3.scale.log(),
                  d3.scale.linear())
        .xDomain(fc.util.extent().fields('income')(data))
        .yDomain(fc.util.extent().pad(0.2).fields('lifeExpectancy')(data))
        .xLabel('Income (dollars)')
        .yLabel('Life expectancy (years)')
        .xTicks(2, d3.format(',d'))
        .chartLabel('The Wealth & Health of Nations')
        .yOrient('left')
        .margin({left: 40, bottom: 40, top: 30})
        .plotArea(pointSeries)
        .decorate(function(selection) {
            selection.enter()
                .append('g')
                .classed('legend-container', true)
                .layout({
                    position: 'absolute',
                    right: 10,
                    bottom: 50,
                    width: 165,
                    height: 100
                });

            // compute layout from the parent SVG
            selection.enter().layout();

            // render the legend
            selection.select('g.legend-container').call(legend);
        });

    d3.select('#bubble-chart')
        .datum(data)
        .call(chart);
});

</script>

<p>This example demonstrates how to render a bubble chart with data that shows the relationship between life expectancy and wealth, obtained via  <a href="http://www.gapminder.org/world/#$majorMode=chart$is;shi=t;ly=2003;lb=f;il=t;fs=11;al=30;stl=t;st=t;nsl=t;se=t$wst;tts=C$ts;sp=5.59290322580644;ti=2013$zpv;v=0$inc_x;mmid=XCOORDS;iid=phAwcNAVuyj1jiMAkmq1iMg;by=ind$inc_y;mmid=YCOORDS;iid=phAwcNAVuyj2tPLxKvvnNPA;by=ind$inc_s;uniValue=8.21;iid=phAwcNAVuyj0XOoBL_n5tAQ;by=ind$inc_c;uniValue=255;gid=CATID0;by=grp$map_x;scale=log;dataMin=194;dataMax=96846$map_y;scale=lin;dataMin=23;dataMax=86$map_s;sma=49;smi=2.65$cd;bd=0$inds=;modified=60">Gapminder</a>. The chart is constructed from the following components:</p>
<ul>
<li>The <code>d3.json</code> component is used to load the data from a JSON file.</li>
<li>A <a href="/components/chart/cartesian.html">cartesian chart</a>, with a logarithmic x scale and linear y scale, is used to render the plot area, axes and labels.</li>
<li>A <a href="/components/series/point.html">point series</a> is used to render the data, with the <code>size</code> of each point defined via another linear scale.</li>
<li>The <a href="/components/introduction/decorate-pattern.html">decorate pattern</a> is used to add a legend (courtesy of the <a href="http://d3-legend.susielu.com">d3-legend</a> project). In this case, the legend is inserted into the SVG via the enter selection, with <a href="/components/layout/flexbox.html">svg flexbox</a> used for positioning.</li>
</ul>
<pre><code class="lang-js">d3.json(<span class="hljs-string">'https://d3fc.io/examples/bubble/data.json'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error, data</span>) </span>{
    <span class="hljs-comment">// convert string properties to numbers</span>
    data.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{
        d.income = <span class="hljs-built_in">Number</span>(d.income);
        d.population = <span class="hljs-built_in">Number</span>(d.population);
        d.lifeExpectancy = <span class="hljs-built_in">Number</span>(d.lifeExpectancy);
    });

    <span class="hljs-built_in">var</span> regions = d3.set(data.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.region; }));
    <span class="hljs-built_in">var</span> <span class="hljs-built_in">color</span> = d3.scale.category10()
        .domain(regions.values());

    <span class="hljs-built_in">var</span> legend = d3.legend.color()
        .scale(<span class="hljs-built_in">color</span>);

    <span class="hljs-built_in">var</span> <span class="hljs-built_in">size</span> = d3.scale.linear()
        .range([<span class="hljs-number">20</span>, <span class="hljs-number">800</span>])
        .domain(fc.util.extent().fields(<span class="hljs-string">'population'</span>)(data));

    <span class="hljs-built_in">var</span> pointSeries = fc.series.point()
        .xValue(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.income; })
        .yValue(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.lifeExpectancy; })
        .size(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-built_in">size</span>(d.population); })
        .decorate(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sel</span>) </span>{
            sel.enter()
                .attr(<span class="hljs-string">'fill'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-built_in">color</span>(d.region); });
        });

    <span class="hljs-built_in">var</span> chart = fc.chart.cartesian(
                  d3.scale.log(),
                  d3.scale.linear())
        .xDomain(fc.util.extent().fields(<span class="hljs-string">'income'</span>)(data))
        .yDomain(fc.util.extent().pad(<span class="hljs-number">0.2</span>).fields(<span class="hljs-string">'lifeExpectancy'</span>)(data))
        .xLabel(<span class="hljs-string">'Income (dollars)'</span>)
        .yLabel(<span class="hljs-string">'Life expectancy (years)'</span>)
        .xTicks(<span class="hljs-number">2</span>, d3.format(<span class="hljs-string">',d'</span>))
        .chartLabel(<span class="hljs-string">'The Wealth &amp; Health of Nations'</span>)
        .yOrient(<span class="hljs-string">'left'</span>)
        .margin({<span class="hljs-attribute">left</span>: <span class="hljs-number">40</span>, <span class="hljs-attribute">bottom</span>: <span class="hljs-number">40</span>, <span class="hljs-attribute">top</span>: <span class="hljs-number">30</span>})
        .plotArea(pointSeries)
        .decorate(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">selection</span>) </span>{
            selection.enter()
                .append(<span class="hljs-string">'g'</span>)
                .classed(<span class="hljs-string">'legend-container'</span>, <span class="hljs-literal">true</span>)
                .layout({
                    <span class="hljs-attribute">position</span>: <span class="hljs-string">'absolute'</span>,
                    <span class="hljs-attribute">right</span>: <span class="hljs-number">10</span>,
                    <span class="hljs-attribute">bottom</span>: <span class="hljs-number">50</span>,
                    <span class="hljs-attribute">width</span>: <span class="hljs-number">165</span>,
                    <span class="hljs-attribute">height</span>: <span class="hljs-number">100</span>
                });

            <span class="hljs-comment">// compute layout from the parent SVG</span>
            selection.enter().layout();

            <span class="hljs-comment">// render the legend</span>
            selection.select(<span class="hljs-string">'g.legend-container'</span>).call(legend);
        });

    d3.select(<span class="hljs-string">'#bubble-chart'</span>)
        .datum(data)
        .call(chart);
});
</code></pre>

    </div>

    <nav class="col-sm-3 hidden-xs">
      <ul class="nav nav-stacked fixed nav-sidebar">
        <li>
          <h4>Examples</h4>
          <ul class="nav nav-stacked">
                <li class="">
                  <a href="/examples/basecoin/index.html">Basecoin</a>
                </li>
                <li class="active">
                  <a href="/examples/bubble/index.html">Bubble Chart</a>
                </li>
                <li class="">
                  <a href="/examples/low-barrel/index.html">Low Barrel</a>
                </li>
                <li class="">
                  <a href="/examples/scatter/index.html">Scatterplot</a>
                </li>
                <li class="">
                  <a href="/examples/simple/index.html">Line / Area Chart</a>
                </li>
                <li class="">
                  <a href="/examples/stacked/index.html">Stacked Bar</a>
                </li>
                <li class="">
                  <a href="/examples/streaming/index.html">Streaming Chart</a>
                </li>
                <li class="">
                  <a href="/examples/wealth-and-health-of-nations/index.html">The Wealth &amp; Health of Nations</a>
                </li>
          </ul>
        </li>
      </ul>
    </nav>
  </div>

</div>


    </div>
    <footer>
      <div class="container">
        <p class="muted credit text-center">Project supported by <a href="http://www.scottlogic.com">Scott Logic</a>.</p>
        <p class="muted credit text-center">Browser testing provided by <a class="browserstack" href="https://browserstack.com">BrowserStack</a>.</p>
      </div>
    </footer>

  </body>
</html>
